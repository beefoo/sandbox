#!/bin/bash

# SLURM job submission script generated by Apache Airavata
#SBATCH -p cloud
#SBATCH -N 1
#SBATCH -n 10
#SBATCH --mail-user=scigap03jobs@scigap.org
#SBATCH -t 12:0:00
#SBATCH -J A176720366
#SBATCH -o standard-output.txt
#SBATCH -e standard-error.txt

#SBATCH --mail-type=ALL

cd /export/reader/carrels/PROCESS_7f6c21b0-94d2-4146-b20e-dd0e999965c6
curl -X POST -H "Content-Type: application/vnd.kafka.json.v2+json" -H "Accept: application/vnd.kafka.v2+json" --data '{"records":[{"value":{"jobName":"A176720366", "status":"RUNNING", "task":"TASK_97bd82cb-91ae-4aa0-bdff-597f32b4420c"}}]}' "http://scigap03.sciencegateways.iu.edu:8082/topics/helix-airavata-mq" > /dev/null || true
export SHELL_NAME=/bin/bash;
export QUEUE_NAME=cloud;
export NODES=1;
export CPU_COUNT=10;
export MAIL_ADDRESS=scigap03jobs@scigap.org;
export ACCOUNT_STRING=null;
export MAX_WALL_TIME=12:0:00;
export JOB_NAME=A176720366;
export STANDARD_OUT_FILE=standard-output.txt;
export STANDARD_ERROR_FILE=standard-error.txt;
export QUALITY_OF_SERVICE=null;
export RESERVATION=null;
export EXPORTS=[];
export MODULE_COMMANDS=[];
export SCRATCH_LOCATION=/export/reader/carrels;
export WORKING_DIR=/export/reader/carrels/PROCESS_7f6c21b0-94d2-4146-b20e-dd0e999965c6;
export PRE_JOB_COMMANDS=null;
export JOB_SUBMITTER_COMMAND=null;
export EXECUTABLE_PATH=/export/reader/bin/files2carrel.sh;
export INPUTS=[input-file.ukn];
export POST_JOB_COMMANDS=null;
export USED_MEM=null;
export PROCESS_PER_NODE=10;
export CHASSIS_NAME=null;
export INPUT_DIR=/export/reader/carrels/PROCESS_7f6c21b0-94d2-4146-b20e-dd0e999965c6;
export OUTPUT_DIR=/export/reader/carrels/PROCESS_7f6c21b0-94d2-4146-b20e-dd0e999965c6;
export USER_NAME=reader;
export GATEWAY_ID=distantreader;
export GATEWAY_USER_NAME=beefoo;
export APPLICATION_NAME=File to study carrel;
/export/reader/bin/files2carrel.sh input-file.ukn 
curl -X POST -H "Content-Type: application/vnd.kafka.json.v2+json" -H "Accept: application/vnd.kafka.v2+json" --data '{"records":[{"value":{"jobName":"A176720366", "status":"COMPLETED", "task":"TASK_97bd82cb-91ae-4aa0-bdff-597f32b4420c"}}]}' "http://scigap03.sciencegateways.iu.edu:8082/topics/helix-airavata-mq" > /dev/null || true

